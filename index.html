<!DOCTYPE html>
<html>
<head>
  <title>Keyboard Event Example</title>
  <style>
    body, html {
      height: 100%;
      margin: 0;
      display: flex;
      flex-direction: column;
    }
    #outputField {
      flex: 1;
      width: 100%;
      resize: none;
      font-size: 16px; /* Default font size */
    }
    #fontSizeSelector {
      position: absolute;
      top: 10px;
      right: 10px;
    }
    #downloadButton {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<select id="fontSizeSelector" onchange="changeFontSize()">
  <option value="12px">12px</option>
  <option value="14px">14px</option>
  <option value="16px" selected>16px</option>
  <option value="18px">18px</option>
  <option value="20px">20px</option>
  <option value="22px">22px</option>
  <option value="24px">24px</option>
</select>

<textarea id="outputField" onkeydown="handleKeyDown(event)"></textarea>
<button id="downloadButton" onclick="downloadText()">Download</button>

<script>
  let lastKeyWasEnter = false;

  function handleKeyDown(event) {
    const outputField = document.getElementById('outputField');

    if (event.location === KeyboardEvent.DOM_KEY_LOCATION_NUMPAD) {
      switch(event.key) {
        case '0':
          event.preventDefault();
          const text = outputField.value;
          outputField.value = text.slice(0, -1); // Remove the last character
          lastKeyWasEnter = false;
          break;
        case '1':
          event.preventDefault();
          outputField.value += 'γ'; // Gamma
          lastKeyWasEnter = false;
          break;
        case '2':
          event.preventDefault();
          outputField.value += 'π'; // Pi
          lastKeyWasEnter = false;
          break;
        case '3':
          event.preventDefault();
          outputField.value += 'β'; // Beta
          lastKeyWasEnter = false;
          break;
        case '4':
          event.preventDefault();
          outputField.value += 'c'; // Custom character
          lastKeyWasEnter = false;
          break;
        case '5':
          event.preventDefault();
          outputField.value += 's'; // Custom character
          lastKeyWasEnter = false;
          break;
        case '6':
          event.preventDefault();
          outputField.value += 'δ'; // Delta
          lastKeyWasEnter = false;
          break;
        case '7':
          event.preventDefault();
          outputField.value += 'e'; // Epsilon
          lastKeyWasEnter = false;
          break;
        case '8':
          event.preventDefault();
          outputField.value += 'y'; // Iota
          lastKeyWasEnter = false;
          break;
        case '9':
          event.preventDefault();
          outputField.value += 'o'; // Omicron
          lastKeyWasEnter = false;
          break;
        case 'Enter':
          event.preventDefault();
          if (lastKeyWasEnter) {
            outputField.value += '\n'; // Move to the next line if Enter pressed consecutively
          } else {
            outputField.value += ' '; // Otherwise, insert a space
          }
          lastKeyWasEnter = !lastKeyWasEnter; // Toggle the flag
          break;
        case '.':
          event.preventDefault();
          outputField.value += '.'; // Decimal point
          lastKeyWasEnter = false;
          break;
        case '+':
          event.preventDefault();
          outputField.value += 'ε'; // Epsilon
          lastKeyWasEnter = false;
          break;
        case '-':
          event.preventDefault();
          outputField.value += '8'; // Custom character
          lastKeyWasEnter = false;
          break;
        case '*':
          event.preventDefault();
          outputField.value += 'h'; // Custom character
          lastKeyWasEnter = false;
          break;
        case '/':
          event.preventDefault();
          outputField.value += '-'; // Theta
          lastKeyWasEnter = false;
          break;
        default:
          event.preventDefault(); // Ignore all other numpad keys
          break;
      }
    } else {
      event.preventDefault(); // Ignore all other keys outside the numpad
    }
  }

  function changeFontSize() {
    const outputField = document.getElementById('outputField');
    const fontSizeSelector = document.getElementById('fontSizeSelector');
    outputField.style.fontSize = fontSizeSelector.value;
  }

  function downloadText() {
    const outputField = document.getElementById('outputField');
    const text = outputField.value;
    const blob = new Blob([text], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'output.txt';
    a.click();
    URL.revokeObjectURL(url);
  }
</script>

</body>
</html>

